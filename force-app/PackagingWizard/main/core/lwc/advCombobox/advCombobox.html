<template>
    <div class="slds-form-element">
        <label class="slds-form-element__label" for="adv-combobox">{label}</label>
        <div class="slds-form-element__control">
            <div class="slds-combobox_container" onmouseleave={handleLeave}>
                <div class={containerCls} aria-expanded="true" aria-haspopup="dialog" role="combobox">
                    <div class="slds-combobox__form-element slds-input-has-icon slds-input-has-icon_right" role="none">
                        <input
                            type="text"
                            class="slds-input slds-combobox__input"
                            id="adv-combobox"
                            aria-controls="popover-unique-id"
                            role="textbox"
                            name={name}
                            disabled={disabled}
                            placeholder={placeholder}
                            readonly
                            value={displayedValue}
                            onclick={toggleOpen}
                            autocomplete="off"
                        />
                        <lightning-icon
                            icon-name="utility:down"
                            size="x-small"
                            class=" slds-input__icon slds-input__icon_right"
                        ></lightning-icon>
                    </div>
                    <section
                        aria-describedby="dialog-body-id"
                        aria-label="Language Options"
                        class="slds-popover slds-popover_full-width"
                        id="popover-unique-id"
                        role="dialog"
                    >
                        <div class="slds-popover__body slds-popover__body_small" id="dialog-body-id">
                            <ul class="slds-listbox slds-listbox_vertical" role="presentation">
                                <template for:each={advOptions} for:item="option">
                                    <li
                                        role="presentation"
                                        class="slds-listbox__item"
                                        key={option.id}
                                        data-value={option.value}
                                        onclick={handleClickOption}
                                    >
                                        <div
                                            id={optionId}
                                            class="slds-media slds-listbox__option slds-listbox__option_plain slds-media_small"
                                            role="option"
                                        >
                                            <span class="slds-media__figure slds-listbox__option-icon">
                                                <lightning-icon
                                                    if:true={option.isSelected}
                                                    icon-name="utility:check"
                                                    size="x-small"
                                                    alternative-text="Checked"
                                                ></lightning-icon>
                                            </span>
                                            <span class="slds-media__body">
                                                <span class="slds-truncate" title={option.label}>{option.label}</span>
                                            </span>
                                        </div>
                                    </li>
                                </template>
                            </ul>
                        </div>
                        <footer class="slds-popover__footer slds-popover__footer_form">
                            <lightning-button
                                variant={button.variant}
                                label={button.label}
                                title={button.title}
                                onclick={handleClickButton}
                                icon-name={button.iconName}
                                class={button.class}
                            ></lightning-button>
                        </footer>
                    </section>
                </div>
            </div>
        </div>
    </div>
</template>
